create table dim_date (
	date date,
	day int,
	month int,
	month_name varchar(20),
	quarter int,
	year int,
	is_weekend boolean,
	is_holiday boolean
	);
	
insert into dim_date (date, day, month, month_name, quarter, year, is_weekend, is_holiday) values
('2025-01-01', 1, 1, 'January', 1, 2025, FALSE, TRUE),
('2025-01-02', 2, 1, 'January', 1, 2025, FALSE, FALSE),
('2025-01-03', 3, 1, 'January', 1, 2025, FALSE, FALSE),
('2025-01-04', 4, 1, 'January', 1, 2025, TRUE, FALSE),
('2025-01-05', 5, 1, 'January', 1, 2025, TRUE, FALSE),
('2025-01-06', 6, 1, 'January', 1, 2025, FALSE, FALSE),
('2025-01-07', 7, 1, 'January', 1, 2025, FALSE, FALSE),
('2025-01-08', 8, 1, 'January', 1, 2025, FALSE, FALSE),
('2025-01-09', 9, 1, 'January', 1, 2025, FALSE, FALSE),
('2025-01-10', 10, 1, 'January', 1, 2025, FALSE, FALSE),
('2025-01-11', 11, 1, 'January', 1, 2025, TRUE, FALSE),
('2025-01-12', 12, 1, 'January', 1, 2025, TRUE, FALSE),
('2025-01-13', 13, 1, 'January', 1, 2025, FALSE, FALSE),
('2025-01-14', 14, 1, 'January', 1, 2025, FALSE, FALSE),
('2025-01-15', 15, 1, 'January', 1, 2025, FALSE, FALSE),
('2025-01-16', 16, 1, 'January', 1, 2025, FALSE, FALSE),
('2025-01-17', 17, 1, 'January', 1, 2025, FALSE, FALSE),
('2025-01-18', 18, 1, 'January', 1, 2025, TRUE, FALSE),
('2025-01-19', 19, 1, 'January', 1, 2025, TRUE, FALSE),
('2025-01-20', 20, 1, 'January', 1, 2025, FALSE, FALSE),
('2025-01-21', 21, 1, 'January', 1, 2025, FALSE, FALSE),
('2025-01-22', 22, 1, 'January', 1, 2025, FALSE, FALSE),
('2025-01-23', 23, 1, 'January', 1, 2025, FALSE, FALSE),
('2025-01-24', 24, 1, 'January', 1, 2025, FALSE, FALSE),
('2025-01-25', 25, 1, 'January', 1, 2025, TRUE, FALSE),
('2025-01-26', 26, 1, 'January', 1, 2025, TRUE, FALSE),
('2025-01-27', 27, 1, 'January', 1, 2025, FALSE, FALSE),
('2025-01-28', 28, 1, 'January', 1, 2025, FALSE, FALSE),
('2025-01-29', 29, 1, 'January', 1, 2025, FALSE, FALSE),
('2025-01-30', 30, 1, 'January', 1, 2025, FALSE, FALSE),
('2025-01-31', 31, 1, 'January', 1, 2025, FALSE, FALSE),
('2025-02-01', 1, 2, 'February', 1, 2025, TRUE, FALSE),
('2025-02-02', 2, 2, 'February', 1, 2025, TRUE, FALSE),
('2025-02-03', 3, 2, 'February', 1, 2025, FALSE, FALSE),
('2025-02-04', 4, 2, 'February', 1, 2025, FALSE, FALSE),
('2025-02-05', 5, 2, 'February', 1, 2025, FALSE, FALSE),
('2025-02-06', 6, 2, 'February', 1, 2025, FALSE, FALSE),
('2025-02-07', 7, 2, 'February', 1, 2025, FALSE, FALSE),
('2025-02-08', 8, 2, 'February', 1, 2025, TRUE, FALSE),
('2025-02-09', 9, 2, 'February', 1, 2025, TRUE, FALSE),
('2025-02-10', 10, 2, 'February', 1, 2025, FALSE, FALSE),
('2025-02-11', 11, 2, 'February', 1, 2025, FALSE, FALSE),
('2025-02-12', 12, 2, 'February', 1, 2025, FALSE, FALSE),
('2025-02-13', 13, 2, 'February', 1, 2025, FALSE, FALSE),
('2025-02-14', 14, 2, 'February', 1, 2025, FALSE, FALSE),
('2025-02-15', 15, 2, 'February', 1, 2025, TRUE, FALSE),
('2025-02-16', 16, 2, 'February', 1, 2025, TRUE, FALSE),
('2025-02-17', 17, 2, 'February', 1, 2025, FALSE, FALSE),
('2025-02-18', 18, 2, 'February', 1, 2025, FALSE, FALSE),
('2025-02-19', 19, 2, 'February', 1, 2025, FALSE, FALSE),
('2025-02-20', 20, 2, 'February', 1, 2025, FALSE, FALSE),
('2025-02-21', 21, 2, 'February', 1, 2025, FALSE, FALSE),
('2025-02-22', 22, 2, 'February', 1, 2025, TRUE, FALSE),
('2025-02-23', 23, 2, 'February', 1, 2025, TRUE, FALSE),
('2025-02-24', 24, 2, 'February', 1, 2025, FALSE, FALSE),
('2025-02-25', 25, 2, 'February', 1, 2025, FALSE, FALSE),
('2025-02-26', 26, 2, 'February', 1, 2025, FALSE, FALSE),
('2025-02-27', 27, 2, 'February', 1, 2025, FALSE, FALSE),
('2025-02-28', 28, 2, 'February', 1, 2025, FALSE, FALSE),
('2025-03-01', 1, 3, 'March', 1, 2025, TRUE, FALSE),
('2025-03-02', 2, 3, 'March', 1, 2025, TRUE, FALSE),
('2025-03-03', 3, 3, 'March', 1, 2025, FALSE, FALSE),
('2025-03-04', 4, 3, 'March', 1, 2025, FALSE, FALSE),
('2025-03-05', 5, 3, 'March', 1, 2025, FALSE, FALSE),
('2025-03-06', 6, 3, 'March', 1, 2025, FALSE, FALSE),
('2025-03-07', 7, 3, 'March', 1, 2025, FALSE, FALSE),
('2025-03-08', 8, 3, 'March', 1, 2025, TRUE, FALSE),
('2025-03-09', 9, 3, 'March', 1, 2025, TRUE, FALSE),
('2025-03-10', 10, 3, 'March', 1, 2025, FALSE, FALSE),
('2025-03-11', 11, 3, 'March', 1, 2025, FALSE, FALSE),
('2025-03-12', 12, 3, 'March', 1, 2025, FALSE, FALSE),
('2025-03-13', 13, 3, 'March', 1, 2025, FALSE, FALSE),
('2025-03-14', 14, 3, 'March', 1, 2025, FALSE, FALSE),
('2025-03-15', 15, 3, 'March', 1, 2025, TRUE, FALSE),
('2025-03-16', 16, 3, 'March', 1, 2025, TRUE, FALSE),
('2025-03-17', 17, 3, 'March', 1, 2025, FALSE, FALSE),
('2025-03-18', 18, 3, 'March', 1, 2025, FALSE, FALSE),
('2025-03-19', 19, 3, 'March', 1, 2025, FALSE, FALSE),
('2025-03-20', 20, 3, 'March', 1, 2025, FALSE, FALSE),
('2025-03-21', 21, 3, 'March', 1, 2025, FALSE, FALSE),
('2025-03-22', 22, 3, 'March', 1, 2025, TRUE, FALSE),
('2025-03-23', 23, 3, 'March', 1, 2025, TRUE, FALSE),
('2025-03-24', 24, 3, 'March', 1, 2025, FALSE, FALSE),
('2025-03-25', 25, 3, 'March', 1, 2025, FALSE, FALSE),
('2025-03-26', 26, 3, 'March', 1, 2025, FALSE, FALSE),
('2025-03-27', 27, 3, 'March', 1, 2025, FALSE, FALSE),
('2025-03-28', 28, 3, 'March', 1, 2025, FALSE, FALSE),
('2025-03-29', 29, 3, 'March', 1, 2025, TRUE, FALSE),
('2025-03-30', 30, 3, 'March', 1, 2025, TRUE, FALSE),
('2025-03-31', 31, 3, 'March', 1, 2025, FALSE, FALSE),
('2025-04-01', 1, 4, 'April', 2, 2025, FALSE, FALSE),
('2025-04-02', 2, 4, 'April', 2, 2025, FALSE, FALSE),
('2025-04-03', 3, 4, 'April', 2, 2025, FALSE, FALSE),
('2025-04-04', 4, 4, 'April', 2, 2025, FALSE, FALSE),
('2025-04-05', 5, 4, 'April', 2, 2025, TRUE, FALSE),
('2025-04-06', 6, 4, 'April', 2, 2025, TRUE, FALSE),
('2025-04-07', 7, 4, 'April', 2, 2025, FALSE, FALSE),
('2025-04-08', 8, 4, 'April', 2, 2025, FALSE, FALSE),
('2025-04-09', 9, 4, 'April', 2, 2025, FALSE, FALSE),
('2025-04-10', 10, 4, 'April', 2, 2025, FALSE, FALSE);

alter table dim_date
add primary key (date);

create table dim_customer (
	customer_key int primary key,
	customer_id int,
	customer_name varchar(200),
	city varchar(200),
	state varchar(200),
	country varchar(200),
	effective_from timestamp,
	effective_to timestamp,
	is_current boolean
	);

alter table dim_customer
alter column customer_id type varchar(20);
	
insert into dim_customer (customer_key, customer_id, customer_name, city, state, country, effective_from, effective_to, is_current) values
(1, 'C001', 'Alice Smith', 'Rotterdam', 'NA', 'Netherlands', '2025-01-01', NULL, TRUE),
(2, 'C002', 'Bob Johnson', 'The Hague', 'NA', 'Netherlands', '2025-01-01', NULL, TRUE),
(3, 'C003', 'Charlie Lee', 'The Hague', 'NA', 'Netherlands', '2025-01-01', NULL, TRUE),
(4, 'C004', 'Diana Brown', 'The Hague', 'NA', 'Netherlands', '2025-01-01', NULL, TRUE),
(5, 'C005', 'Eva Davis', 'Utrecht', 'NA', 'Netherlands', '2025-01-01', NULL, TRUE),
(6, 'C006', 'Frank Wilson', 'Rotterdam', 'NA', 'Netherlands', '2025-01-01', NULL, TRUE),
(7, 'C007', 'Grace Miller', 'The Hague', 'NA', 'Netherlands', '2025-01-01', NULL, TRUE),
(8, 'C008', 'Henry Moore', 'Eindhoven', 'NA', 'Netherlands', '2025-01-01', NULL, TRUE),
(9, 'C009', 'Ivy Taylor', 'Amsterdam', 'NA', 'Netherlands', '2025-01-01', NULL, TRUE),
(10, 'C010', 'Jack Anderson', 'Utrecht', 'NA', 'Netherlands', '2025-01-01', NULL, TRUE),
(11, 'C003', 'Charlie Lee', 'Eindhoven', 'NB', 'Netherlands', '2025-03-16', NULL, TRUE);

create table dim_product (
	product_key int primary key,
	product_id varchar(20),
	product_name varchar(200),
	category varchar(200),
	subcategory varchar(200),
	brand varchar(200)
	);

insert into dim_product (product_key, product_id, product_name, category, subcategory, brand) values
(1, 'P001', 'Organic Hemp Oil', 'Health', 'Oils', 'NatureWell'),
(2, 'P002', 'Hemp Protein Powder', 'Health', 'Supplements', 'BioPower'),
(3, 'P003', 'Eco Yoga Mat', 'Sports', 'Fitness', 'GreenFit'),
(4, 'P004', 'Recycled Water Bottle', 'Home', 'Kitchen', 'EcoHome'),
(5, 'P005', 'Bamboo Toothbrush', 'Health', 'Personal Care', 'EcoBrush'),
(6, 'P006', 'Solar Power Bank', 'Electronics', 'Accessories', 'SunCharge'),
(7, 'P007', 'Biodegradable Phone Case', 'Electronics', 'Accessories', 'EcoTech'),
(8, 'P008', 'Reusable Shopping Bag', 'Home', 'Kitchen', 'GreenBag'),
(9, 'P009', 'Compost Bin', 'Home', 'Garden', 'EcoCycle'),
(10, 'P010', 'Plant-based Protein Bar', 'Food', 'Snacks', 'BioSnack');


create table dim_store (
	store_key int primary key,
	store_id varchar(20),
	store_name varchar(200),
	channel varchar(200),
	city varchar(200),
	region varchar(200)
	);

insert into dim_store (store_key, store_id, store_name, channel, city, region) values
(1, 'S001', 'WageningenMart Online', 'Online', 'Wageningen', 'Gelderland'),
(2, 'S002', 'WageningenMart Utrecht', 'Offline', 'Utrecht', 'Utrecht'),
(3, 'S003', 'WageningenMart Amsterdam', 'Offline', 'Amsterdam', 'NH'),
(4, 'S004', 'WageningenMart Rotterdam', 'Offline', 'Rotterdam', 'ZH'),
(5, 'S005', 'WageningenMart Eindhoven', 'Offline', 'Eindhoven', 'NB'),
(6, 'S006', 'WageningenMart Den Haag', 'Offline', 'The Hague', 'ZH'),
(7, 'S007', 'WageningenMart Groningen', 'Offline', 'Groningen', 'GR'),
(8, 'S008', 'WageningenMart Online 2', 'Online', 'Leiden', 'ZH'),
(9, 'S009', 'WageningenMart Maastricht', 'Offline', 'Maastricht', 'LI'),
(10, 'S010', 'WageningenMart Arnhem', 'Offline', 'Arnhem', 'GE');

create table fact_sales(
	sales_key int primary key,
	order_number varchar(20),
	order_item_seq int,
	date timestamp,
	foreign key (date) references dim_date (date),
	customer_key int,
	foreign key (customer_key) references dim_customer (customer_key),
	product_key int,
	foreign key (product_key) references dim_product (product_key),
	store_key int,
	foreign key (store_key) references dim_store (store_key),
	quantity int,
	gross_amount int,
	discount_amount int, 
	net_amount int
	);

insert into fact_sales (sales_key, order_number, order_item_seq, date, customer_key, product_key, store_key, quantity, gross_amount, discount_amount, net_amount) values
(1, 'O1001', 1, '2025-02-11', 5, 5, 5, 4, 176, 10, 166),
(2, 'O1002', 1, '2025-03-05', 11, 6, 2, 1, 47, 5, 42),
(3, 'O1003', 1, '2025-01-25', 7, 10, 1, 2, 94, 0, 94),
(4, 'O1004', 1, '2025-02-15', 4, 6, 4, 2, 42, 10, 32),
(5, 'O1005', 1, '2025-01-15', 2, 10, 3, 2, 22, 5, 17),
(6, 'O1006', 1, '2025-01-14', 5, 2, 1, 5, 210, 10, 200),
(7, 'O1007', 1, '2025-03-28', 2, 7, 10, 3, 60, 0, 60),
(8, 'O1008', 1, '2025-03-28', 4, 5, 5, 1, 34, 0, 34),
(9, 'O1009', 1, '2025-02-21', 4, 6, 6, 2, 60, 10, 50),
(10, 'O1010', 1, '2025-01-22', 5, 2, 5, 1, 34, 10, 24),
(11, 'O1011', 1, '2025-01-13', 2, 2, 7, 4, 140, 0, 140),
(12, 'O1012', 1, '2025-02-12', 4, 6, 1, 2, 90, 5, 85),
(13, 'O1013', 1, '2025-01-19', 3, 2, 1, 5, 105, 5, 100),
(14, 'O1014', 1, '2025-01-15', 1, 10, 2, 5, 205, 0, 205),
(15, 'O1015', 1, '2025-02-05', 11, 7, 5, 1, 50, 5, 45),
(16, 'O1016', 1, '2025-02-02', 5, 9, 2, 1, 17, 10, 7),
(17, 'O1017', 1, '2025-04-08', 3, 1, 9, 4, 120, 0, 120),
(18, 'O1018', 1, '2025-03-02', 3, 5, 3, 1, 26, 10, 16),
(19, 'O1019', 1, '2025-02-06', 1, 8, 3, 4, 44, 5, 39),
(20, 'O1020', 1, '2025-03-20', 3, 8, 7, 5, 185, 0, 185),
(21, 'O1021', 1, '2025-01-11', 9, 6, 2, 1, 48, 0, 48),
(22, 'O1022', 1, '2025-03-09', 11, 3, 1, 1, 29, 10, 19),
(23, 'O1023', 1, '2025-02-06', 8, 4, 7, 4, 200, 0, 200),
(24, 'O1024', 1, '2025-02-16', 3, 6, 8, 3, 39, 5, 34),
(25, 'O1025', 1, '2025-01-19', 7, 7, 7, 1, 29, 10, 19),
(26, 'O1026', 1, '2025-03-26', 9, 4, 4, 3, 63, 5, 58),
(27, 'O1027', 1, '2025-03-18', 10, 4, 4, 5, 105, 10, 95),
(28, 'O1028', 1, '2025-03-26', 4, 10, 1, 4, 88, 0, 88),
(29, 'O1029', 1, '2025-02-07', 3, 7, 4, 3, 132, 10, 122),
(30, 'O1030', 1, '2025-02-15', 8, 8, 10, 1, 11, 0, 11),
(31, 'O1031', 1, '2025-02-02', 10, 1, 7, 3, 114, 10, 104),
(32, 'O1032', 1, '2025-03-25', 8, 1, 1, 2, 78, 0, 78),
(33, 'O1033', 1, '2025-03-12', 3, 6, 10, 5, 135, 10, 125),
(34, 'O1034', 1, '2025-02-18', 10, 5, 5, 1, 19, 5, 14),
(35, 'O1035', 1, '2025-02-22', 7, 4, 4, 5, 165, 10, 155),
(36, 'O1036', 1, '2025-01-23', 3, 6, 1, 5, 185, 10, 175),
(37, 'O1037', 1, '2025-01-06', 10, 4, 6, 2, 74, 10, 64),
(38, 'O1038', 1, '2025-02-01', 4, 5, 5, 5, 230, 0, 230),
(39, 'O1039', 1, '2025-01-08', 9, 10, 10, 1, 38, 0, 38),
(40, 'O1040', 1, '2025-02-12', 1, 7, 6, 2, 48, 10, 38),
(41, 'O1041', 1, '2025-03-13', 4, 6, 2, 1, 44, 0, 44),
(42, 'O1042', 1, '2025-01-30', 8, 5, 8, 3, 147, 5, 142),
(43, 'O1043', 1, '2025-03-09', 8, 9, 8, 4, 128, 5, 123),
(44, 'O1044', 1, '2025-01-26', 1, 2, 5, 2, 38, 0, 38),
(45, 'O1045', 1, '2025-01-09', 8, 3, 3, 4, 192, 5, 187),
(46, 'O1046', 1, '2025-03-06', 8, 1, 5, 2, 54, 10, 44),
(47, 'O1047', 1, '2025-03-23', 8, 8, 8, 1, 44, 0, 44),
(48, 'O1048', 1, '2025-02-17', 10, 8, 9, 2, 92, 0, 92),
(49, 'O1049', 1, '2025-03-13', 7, 2, 8, 1, 42, 10, 32),
(50, 'O1050', 1, '2025-03-27', 4, 9, 4, 3, 84, 5, 79),
(51, 'O1051', 1, '2025-03-25', 11, 7, 4, 3, 42, 10, 32),
(52, 'O1052', 1, '2025-01-17', 5, 4, 8, 5, 185, 0, 185),
(53, 'O1053', 1, '2025-04-01', 9, 7, 8, 4, 80, 10, 70),
(54, 'O1054', 1, '2025-01-29', 10, 8, 3, 3, 84, 0, 84),
(55, 'O1055', 1, '2025-01-07', 6, 1, 8, 3, 51, 5, 46),
(56, 'O1056', 1, '2025-02-11', 9, 6, 7, 3, 39, 5, 34),
(57, 'O1057', 1, '2025-03-08', 11, 1, 10, 3, 81, 10, 71),
(58, 'O1058', 1, '2025-01-07', 5, 2, 3, 2, 66, 10, 56),
(59, 'O1059', 1, '2025-03-02', 2, 1, 6, 5, 165, 0, 165),
(60, 'O1060', 1, '2025-01-07', 4, 5, 2, 4, 80, 0, 80),
(61, 'O1061', 1, '2025-03-02', 8, 1, 6, 1, 10, 0, 10),
(62, 'O1062', 1, '2025-03-08', 3, 8, 4, 5, 70, 0, 70),
(63, 'O1063', 1, '2025-03-16', 8, 2, 2, 1, 48, 5, 43),
(64, 'O1064', 1, '2025-01-01', 3, 10, 8, 5, 205, 10, 195),
(65, 'O1065', 1, '2025-03-24', 1, 8, 8, 5, 180, 5, 175),
(66, 'O1066', 1, '2025-02-24', 11, 2, 1, 2, 66, 0, 66),
(67, 'O1067', 1, '2025-01-25', 7, 6, 10, 3, 132, 5, 127),
(68, 'O1068', 1, '2025-03-11', 10, 5, 1, 3, 111, 0, 111),
(69, 'O1069', 1, '2025-02-14', 7, 3, 8, 3, 30, 0, 30),
(70, 'O1070', 1, '2025-02-17', 8, 2, 8, 4, 68, 5, 63),
(71, 'O1071', 1, '2025-02-12', 8, 10, 3, 1, 43, 10, 33),
(72, 'O1072', 1, '2025-01-22', 3, 9, 2, 1, 11, 5, 6),
(73, 'O1073', 1, '2025-03-05', 5, 8, 9, 5, 55, 10, 45),
(74, 'O1074', 1, '2025-04-04', 11, 3, 9, 1, 31, 0, 31),
(75, 'O1075', 1, '2025-02-13', 9, 6, 1, 2, 64, 0, 64),
(76, 'O1076', 1, '2025-03-28', 6, 2, 2, 5, 245, 0, 245),
(77, 'O1077', 1, '2025-03-09', 3, 6, 8, 3, 147, 10, 137),
(78, 'O1078', 1, '2025-03-22', 10, 4, 10, 1, 12, 10, 2),
(79, 'O1079', 1, '2025-02-19', 7, 10, 10, 1, 24, 10, 14),
(80, 'O1080', 1, '2025-02-18', 11, 8, 4, 2, 60, 0, 60),
(81, 'O1081', 1, '2025-01-15', 7, 7, 9, 4, 112, 10, 102),
(82, 'O1082', 1, '2025-03-30', 2, 10, 9, 5, 85, 10, 75),
(83, 'O1083', 1, '2025-01-07', 4, 9, 7, 2, 30, 0, 30),
(84, 'O1084', 1, '2025-01-16', 2, 2, 7, 5, 120, 10, 110),
(85, 'O1085', 1, '2025-01-31', 10, 8, 10, 3, 42, 10, 32),
(86, 'O1086', 1, '2025-03-11', 9, 10, 8, 5, 230, 5, 225),
(87, 'O1087', 1, '2025-02-10', 10, 8, 1, 5, 235, 5, 230),
(88, 'O1088', 1, '2025-01-21', 6, 4, 5, 1, 19, 10, 9),
(89, 'O1089', 1, '2025-01-24', 1, 7, 4, 2, 84, 0, 84),
(90, 'O1090', 1, '2025-01-23', 10, 2, 9, 5, 230, 0, 230),
(91, 'O1091', 1, '2025-03-04', 11, 10, 10, 1, 16, 5, 11),
(92, 'O1092', 1, '2025-03-09', 2, 2, 5, 5, 150, 10, 140),
(93, 'O1093', 1, '2025-01-23', 4, 9, 7, 5, 170, 0, 170),
(94, 'O1094', 1, '2025-02-01', 2, 3, 7, 4, 116, 0, 116),
(95, 'O1095', 1, '2025-02-22', 8, 7, 10, 2, 94, 0, 94),
(96, 'O1096', 1, '2025-04-06', 11, 10, 2, 4, 116, 0, 116),
(97, 'O1097', 1, '2025-01-25', 9, 2, 6, 2, 70, 5, 65),
(98, 'O1098', 1, '2025-02-03', 7, 4, 4, 5, 210, 5, 205),
(99, 'O1099', 1, '2025-03-26', 2, 8, 6, 2, 44, 10, 34),
(100, 'O1100', 1, '2025-03-10', 4, 5, 7, 1, 47, 0, 47);

